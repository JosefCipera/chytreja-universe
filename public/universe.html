<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>VesmÃ­r Desktop ðŸŒŒ</title>

    <!-- ðŸ“¦ Knihovny -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vis-network@9.1.9/dist/vis-network.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vis-network@9.1.9/dist/vis-network.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- ðŸŽ¨ Styl -->
    <link rel="stylesheet" href="./assets/css/universe.css">
</head>

<body>
    <!-- ðŸ§­ HornÃ­ liÅ¡ta -->
    <div class="app-header">
        <h1 id="appTitle">ChytrÃ© JÃ¡</h1>
        <select id="modelSelector" class="model-selector">
            <option value="dlouhovekost" selected>DlouhovÄ›kost</option>
            <option value="toc">TOC â€“ Teorie omezenÃ­</option>
        </select>
    </div>

    <!-- ðŸŒŒ PlÃ¡tno sÃ­tÄ› -->
    <div id="network"></div>

    <!-- === ðŸŒŒ PostrannÃ­ panel s helperem === -->
    <aside id="sidePanel">
        <div class="panel-header">
            <h2 id="nodeTitle">UzlovÃ½ nÃ¡zev</h2>
            <button class="panel-close" id="closePanel">âœ–</button>
        </div>

        <div class="panel-content">
            <p class="definition" id="nodeDef"></p>

            <hr>
            <h3>ðŸ’¬ MyÅ¡lenky</h3>
            <ul id="nodeThoughts"></ul>

            <hr>
            <h3>ðŸ“˜ Dokumenty</h3>
            <ul id="nodeDocs"></ul>

            <hr>
            <h3>ðŸŽ¬ MÃ©dia</h3>
            <ul id="nodeMedia"></ul>

            <hr>
            <h3>ðŸ§© Ãšlohy</h3>
            <ul id="nodeTasks"></ul>
        </div>

        <!-- ðŸ§  AI Helper -->
        <div id="aiHelper" class="mini">
            <div class="aih-header">
                <span>ðŸ§  ChytrÃ© JÃ¡</span>
                <button id="aihClose">âœ–</button>
            </div>

            <div class="aih-body">
                <div id="aihMessages" class="aih-messages"></div>
                <div class="aih-input">
                    <button id="aihMic"><i class="fa-solid fa-microphone"></i></button>
                    <input id="aihInput" type="text" placeholder="Zeptej se na cokolivâ€¦" />
                    <button id="aihSend"><i class="fa-solid fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </aside>

    <!-- === ðŸ“„ Overlay pro dokumenty (MD/PDF) === -->
    <div id="docOverlay">
        <div id="docViewer">
            <button id="closeDoc" title="ZavÅ™Ã­t">âœ–</button>
            <iframe id="docFrame" src=""></iframe>
        </div>
    </div>

    <!-- ðŸ¤– AI Helper logika -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const helper = document.getElementById("aiHelper");
            const header = helper.querySelector(".aih-header");
            const input = document.getElementById("aihInput");
            const sendBtn = document.getElementById("aihSend");
            const micBtn = document.getElementById("aihMic");
            const messages = document.getElementById("aihMessages");
            const close = document.getElementById("aihClose");

            // ðŸ—¨ï¸ PÅ™idÃ¡nÃ­ zprÃ¡vy
            const append = (text, who = "ai") => {
                const div = document.createElement("div");
                div.className = `msg ${who}`;
                div.textContent = text;
                messages.appendChild(div);
                messages.scrollTop = messages.scrollHeight;
            };

            // ðŸ’¬ OdpovÄ›di helperu
            const reply = t => {
                const q = t.toLowerCase();
                if (q.includes("spÃ¡nek")) return "SpÃ¡nek je zÃ¡klad â€“ 7â€“8 hodin a tma.";
                if (q.includes("vÃ½roba")) return "Najdi ÃºzkÃ© mÃ­sto a zesil tok. âš™ï¸";
                if (q.includes("ahoj")) return "Ahoj ðŸ‘‹, jsem ChytrÃ© JÃ¡. Jak ti mohu pomoct?";
                return "ZajÃ­mavÃ©, povÄ›z mi vÃ­câ€¦ ðŸ¤”";
            };

            // ðŸš€ OdeslÃ¡nÃ­ zprÃ¡vy
            const send = () => {
                const text = input.value.trim();
                if (!text) return;
                append(text, "user");
                input.value = "";
                setTimeout(() => append(reply(text), "ai"), 400);
            };

            // ðŸ”„ PÅ™epÃ­nÃ¡nÃ­ reÅ¾imÅ¯ helperu
            header.addEventListener("click", () => helper.classList.toggle("mini"));
            close.addEventListener("click", e => {
                e.stopPropagation();
                helper.classList.add("mini");
            });

            sendBtn.addEventListener("click", send);
            input.addEventListener("keydown", e => { if (e.key === "Enter") send(); });

            // ðŸŽ™ï¸ Mikrofon â€“ placeholder
            micBtn.addEventListener("click", () => append("ðŸŽ¤ ZÃ¡znam hlasu zatÃ­m nenÃ­ aktivnÃ­.", "ai"));

            // ðŸ§  ÃšvodnÃ­ zprÃ¡va
            append("Ahoj ðŸ‘‹ jsem ChytrÃ© JÃ¡. Ptej se na cokoliv.", "ai");
        });
    </script>

    <!-- ðŸš€ Inicializace vesmÃ­ru -->
    <script type="module" src="./assets/js/universe-init.js"></script>
</body>

</html>